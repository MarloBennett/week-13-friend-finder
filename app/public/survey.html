<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Friend Survey</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>



</head>
<body>

    <div class="container">

        <div class="jumbotron">
            <h1 class="text-center"><span class="glyphicon glyphicon-star-empty"></span> Friend Finder <span class="glyphicon glyphicon-star-empty"></h1>
            <hr>
            <h2 class="text-center">Take the friend survey!</h2>
            <br>

            <div class="text-center">
                <a href="/"><button type="button" class="btn btn-lg btn-primary"><span class="glyphicon glyphicon-home"></span> Home</button></a>
            </div>

        </div>

        <div class="row">
            <div class="col-lg-12">

                <!-- Reservation Page -->
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">Survey</h4>
                    </div>
                    
                    <div class="panel-body">

                      <form role="form"> 
                        <h3>About You</h3>

                           <!-- <div class="form-group">-->
                              <!--  <label for="">Name</label>-->
                            <h4>Name</h4>
                                <input type="text" class="form-control" id="user_name" required>
                           <!-- </div>-->

                           <!-- <div class="form-group">-->
                              <!--  <label for="">Link to photo image</label>-->
                            <h4>Link to Photo (Required)</h4>
                                <input type="text" class="form-control" id="photo_link" required>
                          <!--  </div>-->

                        <h3>Questions</h3>

                            <h4>1. You think dogs are pretty much the best thing ever.</h4>

                            <select data-placeholder class="chosen-select" id="q1">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>2. You think cats are pretty much the best thing ever.</h4>

                            <select data-placeholder class="chosen-select" id="q2">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>3. You <em>know</em> Harry Potter is the best thing ever.</h4>

                            <select data-placeholder class="chosen-select" id="q3">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>4. You like pi&ntilde;a coladas.</h4>

                            <select data-placeholder class="chosen-select" id="q4">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>5. You like getting caught in the rain.</h4>

                            <select data-placeholder class="chosen-select" id="q5">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>6. You were worried we were going to continue in that direction.</h4>

                            <select data-placeholder class="chosen-select" id="q6">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>7. You wish you were playing a video game right now.</h4>

                            <select data-placeholder class="chosen-select" id="q7">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>8. You wish you were playing outside right now.</h4>

                            <select data-placeholder class="chosen-select" id="q8">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>9. You wish you had a pi&ntilde;a colada right now.</h4>

                            <select data-placeholder class="chosen-select" id="q9">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <h4>10. You wish you had a whiskey right now.</h4>

                            <select data-placeholder class="chosen-select" id="q10">
                                <option value></option>
                                <option value="1">1 (Strongly Disagree)</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5 (Strongly Agree)</option>
                            </select>

                            <br /><br />

                            <button type="submit" class="btn btn-primary submit">Submit</button>
                         </form> 

                    </div>
                </div>

            </div>
        </div>

    <footer class="footer">
        <div class="container">
            <p><a href="/api/friends">API Friends Link</a></p>
        </div>
    </footer>

    </div>


</body>
</html>

<script type="text/javascript">

var currentURL = window.location.origin;

    $(".submit").on("click", function(){

        // capture info from form
        newFriend = {
            name: $("#user_name").val().trim(),
            image: $("#photo_link").val().trim(),
            scores: [
                $("#q1").val(),
                $("#q2").val(),
                $("#q3").val(),
                $("#q4").val(),
                $("#q5").val(),
                $("#q6").val(),
                $("#q7").val(),
                $("#q8").val(),
                $("#q9").val(),
                $("#q10").val()
            ]
        };

        console.log(newFriend);

        // This line is the magic. It's very similar to the standard ajax function we used.
        // Essentially we give it a URL, we give it the object we want to send, then we have a "callback".
        // The callback is the response of the server. 

        // Here we get the location of the root page.
        // We use this instead of explicitly saying the URL is localhost:3000 because the url will change when we deploy.
       // currentURL = window.location.origin;

        //post to friends
        $.post(
            currentURL + "/api/friends", 
            newFriend,
            function(data){
                console.log("new friend submitted");

                // Clear the form when submitting
                $("#user_name").val("");
                $("#photo_link").val("");
                $("#q1").val("");
                $("#q2").val("");
                $("#q3").val("");
                $("#q4").val("");
                $("#q5").val("");
                $("#q6").val("");
                $("#q7").val("");
                $("#q8").val("");
                $("#q9").val("");
                $("#q10").val("");

            }
        );

    runFriendQuery();

    return false;


    });

function runFriendQuery() {

    //use friends api url to get its data
    $.ajax({url: currentURL + "/api/friends", method: "GET"})
        .done(function(friendsData) {

            //log url for reference
            console.log("------------------------------------");
            console.log("URL: " + currentURL + "/api/friends");
            console.log("------------------------------------");

            //log info returned from get
            console.log(friendsData);
            console.log("------------------------------------");

            for (var i = 0; i < friendsData.length; i++) {
                console.log(friendsData[i].name);
            }

        });
}    

//runFriendQuery();

</script>
